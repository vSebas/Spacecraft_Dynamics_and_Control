function C = CRP2DCM(q)
    mat = [ 1+q(1)^2-q(2)^2-q(3)^2, 2*(q(1)*q(2)+q(3)),     2*(q(1)*q(3)-q(2));
            2*(q(2)*q(1)-q(3)),     1-q(1)^2+q(2)^2-q(3)^2, 2*(q(2)*q(3)+q(1));
            2*(q(3)*q(1)+q(2)),     2*(q(3)*q(2)-q(1)),     1-q(1)^2-q(2)^2+q(3)^2];
    C = 1/(1+q'*q) * mat;
end